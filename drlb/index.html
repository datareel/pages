<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="DataReel Software Development">
    <meta name="author" content="DataReel Software Development">
    <meta name="title" content="DataReel OpenSource" />
    <meta name="creator" content="DataReel Software Development" />
    <meta name="publisher" content="DataReel Software Development" />
    <meta name="contributor" content="DataReel Software Development" />
    <meta name="date.created" scheme="ISO8601" content="2016-08-20" />
    <meta name="date.reviewed" scheme="ISO8601" content="2016-08-20" />
    <meta name="language" scheme="DCTERMS.RFC1766" content="EN-US" />
    <meta name="keywords" content="Database, Linux, Applications, load
				   balancer, cluster manager, DRLB, DRCM,
				   Communications, Sockets, Threads, C++,
				   Programming, Windows, open source,
				   multi-threaded, cross-platform,
				   commercial, individual, academic, 
				   modular" />
    <meta name="rights" content="http://datareel.com" />
    <meta name="rating" content="General" />
    <meta name="Distribution" content="Global" />
    <meta name="Revisit-after" content="1 week">
    <meta name="robots" content="index,follow" />
    <link rel="icon" href="../images/favicon.ico">
    <title>Load Balancer</title>
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/ie10-viewport-bug-workaround.css" rel="stylesheet">
    <link href="../css/starter-template.css" rel="stylesheet">
    <script src="../js/ie-emulation-modes-warning.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements
    and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed"
          data-toggle="collapse" data-target="#navbar"
          aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://datareel.com/">DataReel Open Source</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li><a href="../clib/index.html">C/C++ Library</a></li>
            <li><a href="../drcm/index.html">Cluster Manager</a></li>
            <li class="active"><a href="index.html">Load Balancer</a></li>
	    <li><a href="ldm.html">DRLB LDM service</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">

      <div>
<!-- My Content Starts Below -->

<!-- Start company logo -->
<center><img src="../images/drlogo1.jpg" /></center>
<!-- End company logo --><!-- Start Menu -->
<hr color="#000000" noshade="noshade" size="1" /><!-- Begin Title Bar --
				-- -->
<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;Contents</b></font></td>
      </tr>
    </tbody>
</table>
<br />
<!-- End Title Bar -->

<p>
<a href="#Overview">Overview</a><br />
<a href="#Features">Features</a><br />
<a href="#DocumentedUsage">Documented Usage</a><br />
<a href="#Building">Building</a><br />
<a href="#RPMInstall">RPM Install</a><br />
<a href="#Installing from src build">Installing</a><br />
<a href="#Buildingadefaultconfigurationfile">Building a default configuration file</a><br />
<a href="#TestDRLBconfigurationsfiles">Testing DRLB configurations files</a><br />
<a href="#RunningDRLBasaservice">Running DRLB as a service</a><br />
<a href="#ConfigurationChanges">Configuration Changes</a><br />
<a href="#Settingthelisteningport">Setting the listening port</a><br />
<a href="#Roundrobinconfiguration">Round robin configuration</a><br />
<a href="#Weightedconfiguration">Weighted configuration</a><br />
<a href="#Distributedconfiguration">Distributed configuration</a><br />
<a href="#Assignedconfiguration">Assigned configuration</a><br />
<a href="#Throttlingconfiguration">Throttling configuration</a><br />
<a href="#Logconfiguration">Log configuration</a><br />
<a href="#Statisticscollection">Statistics collection</a><br />
<a href="#Settingconnectionandthreadlimits">Setting connection and thread limits</a><br />
<a href="#Settingbufferandcachingoptions">Setting buffer and caching options</a><br />
<a href="#Deadnoderetrysettings">Dead node retry settings</a><br />
<a href="#Bufferoverflowsettings">Buffer overflow settings</a><br />
<a href="#Advancedsocketsettings">Advanced socket settings</a><br />
<a href="#DRLBprocessmonitoring">DRLB process monitoring</a><br />
<a href="#SettingOpenFileLimits">Setting Open File Limits</a><br />
<a href="#LinuxKernelTuning">Linux Kernel Tuning</a><br />
<a href="#TestingwithApache">Testing with Apache</a><br />
<a href="#HTTPIPaddressforwarding">HTTP IP address forwarding</a><br />
<a href="#Remainingworkonthisproject">Remaining work on this project</a><br />
<a href="#SupportandBugTracking">Support and Bug Tracking</a><br />

<!-- Begin Title Bar -->
<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="Overview">Overview</a></b></font></td>
    </tr>
  </tbody>
</table>
<!-- End Title Bar -->
<br />
<p>
The DataReel load balancer (LB) is a software based TCP load balancing
solution designed to run on Linux operating systems. The DRLB project
was designed to handle any type of TCP connection, acting as a front
end server distributing high volumes of TCP connections to multiple
back end servers. Load balancing protects your back end servers from
saturation when you have more clients connections than any one server
can handle. The DRLB server can be used as a high availability
resource to provide seamless server fail over. In signal server
environments the DRLB server can provide connection limits and cached
buffing.
<br /><br />
The DRLB source code is distributed as an open source project under
the GNU general public license and can used by freely by commercial,
Government, and academic institutions.
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<!-- Begin Title Bar -->
<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="Features">Fetures</a></b></font></td>
    </tr>
  </tbody>
</table>
<!-- End Title Bar -->
<br />
<p>
<ul>
<li>Round robin: Distribute connections equally to server nodes in order received.</li>

<li>Weighted: Distribute connections based on a weight value assigned to each server node.</li>

<li>Distributed: Distribute connections based on a load percentage assigned to each server node.</li>

<li>Assigned: Assign connections to specific server nodes with the
  option to use round robin, weighted, or distributed load balancing
  for fail over and unassigned connections.</li>

<li>Connection throttling: Prevent server saturation by throttling
  connections based on preset connections values or number of
  connection per second.</li>

<li>Statistics: Option to log connection information and monitor
  connections per second in real time.</li>

<li>Connection limits: Option to set connections per server node or all
  server nodes.</li>

<li>Caching: Buffer server connections with option to set custom buffer
  sizes.</li>

<li>Buffer overflow detection: Option to detect buffer overflows for
  specific applications.</li>
</ul>
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="DocumentedUsage">Documented Usage</a></b></font></td>
    </tr>
  </tbody>
</table>
<br />
<p>
<ul>
<li>All commands prefixed with the $ prompt indicate the command is executed from a user account or from a service account.</li>

<li>All commands prefixed with the # prompt indicate the command is executed as root.</li>

<li>In a configuration file example a ... symbol indicates omitted content for brevity.</li>
</ul>
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<!-- Begin Title Bar -->
<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="Building">Building</a></b></font></td>
    </tr>
  </tbody>
</table>
<!-- End Title Bar -->
<br />
<p>
Developers, follow the instructions below to build the DRLB server:
<pre>
$ cd $HOME
$ mkdir -pv git
$ cd $HOME/git
$ git clone https://github.com/datareel/datareel
$ source $HOME/git/datareel/env/gnu_env.sh
$ cd $HOME/git/datareel/load_balancer/drlb_server
$ make
</pre>
Build a default configuration to test with:
<pre>
$ ./drlb_server --verbose --debug --config-file=/tmp/lb_test_config.cfg
</pre>
The default configuration file is set up for 4 back end nodes running
Apache and the frontend LB listening on port 8080. NOTE: For testing
port 8080 is used so the LB server can be started without root
privileges. The default configuration file is documented with
comments. A set of example config files in the etc directory: 
<pre>
$ ls -l $HOME/git/datareel/load_balancer/etc
</pre>
Once your configuration is set up, run a test with debug and logging enabled:
<pre>
$ ./drlb_server --verbose --debug --config-file=/tmp/lb_test_config.cfg --log-file=/tmp/lb_test.log
</pre>
</p>
<p class="pull-left"><a href="#">Back to top</a></p>


<!-- Begin Title Bar -->
<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="RPMInstall">RPM Install</a></b></font></td>
    </tr>
  </tbody>
</table>
<!-- End Title Bar -->
<br />
<p>
System administrators, follow the instructions below to build an RPM
for distribution:
<pre>
$ cd $HOME; mkdir -pv git; cd $HOME/git
$ git clone https://github.com/datareel/datareel
$ cd ${HOME}/git/datareel/load_balancer/rpm_builder
</pre>
RHEL7/CENTOS7:
<pre>
$ ./make_rhel7_rpm.sh
$ sudo su root -c "yum -y install ${HOME}/rpmbuild/RPMS/x86_64/drlb_server-1.57-1.el7.x86_64.x86_64.rpm"
</pre>
RHEL6/CENTOS6:
<pre>
$ ./make_rhel6_rpm.sh
sudo su root -c "yum -y install ${HOME}/rpmbuild/RPMS/x86_64/drlb_server-1.57-1.el6.x86_64.x86_64.rpm"
</pre>
Useful RPM command to verify package contents:
<br /><br />
List package: rpm -qf /usr/sbin/drlb_server
List files: rpm -ql drlb_server
List configs: rpm -qc drlb_server
List docs: rpm -qd drlb_server
<br /><br />
To remove package:
<pre>
$ sudo su root -c "yum -y remove drlb_server"
</pre>
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<!-- Begin Title Bar -->
<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="Installing">Installing
      from src build</a></b></font></td>
    </tr>
  </tbody>
</table>
<!-- End Title Bar -->
<br />
<p>
The development version can be installed on CENTOS6/RHEL6 or
CENTOS7/RHEL7 from the makefile:
<pre>
$ cd $HOME/git/datareel/load_balancer/drlb_server
$ sudo su root -c &#39;make install_root&#39;
</pre>
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="Buildingadefaultconfigurationfile">Building a default configuration file</a></b></font></td>
    </tr>
  </tbody>
</table>
<br />
<p>
The DRLB server is deigned as generic load balancer and can handle
many LB configurations. To build a configuration template, run the following
command: 
<pre>
# /usr/sbin/drlb_server --check-config --config-file=/etc/drlb/http_lb.cfg

Running DRLB configuration check and exiting
Loading or building config file http_lb.cfg
DRLB configuration file not found. Building default file and exiting
</pre>
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="TestDRLBconfigurationsfiles">Testing DRLB configurations files</a></b></font></td>
    </tr>
  </tbody>
</table>
<br />
<p>
After editing a DRLB configuration file you must check your
configuration file for errors before starting or restarting the DRLB server:
<pre>
# /usr/sbin/drlb_server --check-config --config-file=/etc/drlb/http_lb.cfg | grep -i -E &#39;error|warn|fail|info|notice&#39;
</pre>
If you have any errors or warnings, review and edit your configuration file:
<pre>
# /usr/sbin/drlb_server --check-config --config-file=/etc/drlb/http_lb.cfg
</pre>
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="RunningDRLBasaservice">Running DRLB as a service</a></b></font></td>
    </tr>
  </tbody>
</table>
<br />
<p>
DRLB is designed to run multiple load balancer configurations on
single Linux server. When the drlb_server service is started, the
service initialization script checks the following file for active
server configurations:
<br /><br />
/etc/drlb/active_configs.list
<br /><br />
To add configurations, edit the active configs list:
<br /><br />
# vi /etc/drlb/active_configs.list
<pre>
# List of active DRLB configurations

/etc/drlb/http_rr_test.cfg
/etc/drlb/ldm_cluster.cfg

# List all the LB configs you need to start on this server.
# All entries must use an absolute path to the .cfg file.
</pre>
Save your changes and exit vi.
<br /><br />
If you want to use a single configuration or override the DRLB service 
defaults, edit the following file:
<br /><br />
# vi /etc/sysconfig/drlb_server
<pre>
# File used to override the init script VARs

# Set to change the name of the server binary
##LBPROCNAME=&quot;drlb_server&quot;

# Set to change the path to the server binary
##LBPROC=&quot;/usr/sbin/${LBPROCNAME}&quot;

# Set to change location of active config list
##ACTIVE_CONFIGS=&quot;/etc/drlb/active_configs.list&quot;

# NOTE: Set for single config if you wish to run only on LB server
###SINGLECONFIG=/etc/drlb/http_rr_test.cfg
</pre>
After setting up your DRLB configuration files and your active
configuration list, start the DRLB
server and make the DRLB service persistent:
<br /><br />
RHEL 7/CENTOS 7:
<pre>
# systemctl start drlb_server
# systemctl status drlb_server
# systemctl enable drlb_server
</pre>
RHEL 6/CENTOS 6:
<pre>
# service drlb_server start
# service drlb_server status
# chkconfig drlb_server on
</pre>
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="ConfigurationChanges">Configuration Changes</a></b></font></td>
    </tr>
  </tbody>
</table>
<br />
<p>
All changes to a DRLB configuration file or assignment rules will
require a server restart:
<br /><br />
RHEL 7/CENTOS 7:
<pre>
# systemctl restart drlb_server
</pre>
RHEL 6/CENTOS 6:
<pre>
# service drlb_server restart
</pre>
For DRLB configurations running more than one LB server you can
manually restart the each server instance:
<pre>
# ps -ef | grep drlb_server | grep -v grep

root 17058 1 0 23:57 ? 00:00:00 /usr/sbin/drlb_server --config-file=/etc/drlb/http_rr_test.cfg
root 17075 1 0 23:57 ? 00:00:00 /usr/sbin/drlb_server --config-file=/etc/drlb/ldm_cluster.cfg
</pre>
In the example above you can restart only the http_rr_test.cfg
instance by manually stopping and starting process ID 17058:
<pre>
# kill  17058
# /usr/sbin/drlb_server –config-file=/etc/drlb/http_rr_test.cfg &
# ps -ef | grep drlb_server | grep -v grep
</pre>
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="Settingthelisteningport">Setting the listening port</a></b></font></td>
    </tr>
  </tbody>
</table>
<br />
<p>
The DRLB server listens for incoming TCP connections on a port number
specified in the global server configuration. The DRLB server
distributes incoming TCP connections to back end server nodes. In
the DRLB configuration you are setting up for a load balanced service
you must specify the front end listening port in the global
[LBSERVER] config section. For each back end node you must specify the
back end listening port for each&#39;s node [LBNODE] config section. For
example, if you created a configuration template named &quot;http_lb.cfg&quot;
make the following entries to set the listening ports. NOTE: The
port numbers used in the example below must be substituted with the
port number you are actually using. The use of 4 LBNODE sections is
just an example. Your setup can contain any number of LBNODE sections
depending on how many back end server nodes you have available.     
<pre>
[LBSERVER]
port = 8080 # All incoming traffic connections here 
...

[LBNODE]
node_name = lbnode1
port_number = 80 # Port backend host is listening on
...

[LBNODE]
node_name = lbnode2
port_number = 80
...

[LBNODE]
node_name = lbnode3
port_number = 80
...

[LBNODE]
node_name = lbnode4
port_number = 80
...
</pre>
NOTE: For developers, if your [LBSERVER] port is less than 1024 you
will require root privileges to start the DRLB program for testing.
<br />
NOTE: For system administrators, you are still required to adhere to
all your required service security settings on each back end server node.
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="Roundrobinconfiguration">Round robin configuration</a></b></font></td>
    </tr>
  </tbody>
</table>
<br />
<p>
The round robin load balancing scheme distributes TCP connections
equally to all back end server nodes. For round robin to work
efficiently on bare metal servers, each back end server should have
the same or very similar hardware specifications. For virtual machines
each back end server should be setup with the same amount of CPU,
memory, and disk image parameters. To select round robin, set the
[LBSERVER] scheme to LB_RR. The [LBNODE] sections require a node
name, port number, and the node&#39;s IP address. For example:
<pre>
[LBSERVER]
scheme = LB_RR

[LBNODE]
node_name = lbnode1
port_number = 80
hostname = 192.168.122.111

[LBNODE]
node_name = lbnode2
port_number = 80
hostname = 192.168.122.112

[LBNODE]
node_name = lbnode3
port_number = 80
hostname = 192.168.122.113

[LBNODE]
node_name = lbnode4
port_number = 80
hostname = 192.168.122.114
</pre>
NOTE: The port numbers in the above example must be substituted
with the port number you are actually using. The use of 4 LBNODE
sections is just an example. Your setup may contain any number of
LBNODE sections depending on how many back end server nodes you have
available.  
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="Weightedconfiguration">Weighted configuration</a></b></font></td>
    </tr>
  </tbody>
</table>
<br />
<p>
The weighed round robin load balancing scheme distributes TCP
connections based on a weight value you assign to each back end server
node. Weighted round robin allows you to use servers with different
hardware configurations, where one or more back end server cannot
handle the same load as other servers. The DRLB weight value
represents a number of connections per node. The nodes with the highest
weight values will get the most connections. The nodes with the lowest
weight values will get the lease number of connections. To select
weighted round robin, set the [LBSERVER] scheme to LB_WEIGHTED. The
[LBNODE] sections require a node name, port number, the node&#39;s IP
address, and a weight value. 
<br /><br />
In the example below, lbnode4 will carry 4 times the amount of
connections than lbnode3, lbnode1 and lbnode2. Lbnode3 will carry 3
times the amount of connections than lbnode1 and lbnode2. Lbnode1 and
lbnode2 will get the lease amount of connections. For example:
<pre>
[LBSERVER]
scheme = LB_WEIGHTED

[LBNODE]
node_name = lbnode1
port_number = 80
hostname = 192.168.122.111
weight = 1

[LBNODE]
node_name = lbnode2
port_number = 80
hostname = 192.168.122.112
weight = 1

[LBNODE]
node_name = lbnode3
port_number = 80
hostname = 192.168.122.113
weight = 2

[LBNODE]
node_name = lbnode4
port_number = 80
hostname = 192.168.122.114
weight = 3
</pre>
NOTE: The port numbers in the above example must be substituted
with the port number you are actually using. The use of 4 LBNODE
sections is just an example. Your setup may contain any number of
LBNODE sections depending on how many back end server nodes you have
available.  
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="Distributedconfiguration">Distributed configuration</a></b></font></td>
    </tr>
  </tbody>
</table>
<br />
<p>
The distributed load balancing scheme distributes TCP connections
based on a percentage value you assign to each back end server
node. Similar to weighted round robin, distributed load balancing
allows you to use servers with different hardware configurations,
where one or more back end server cannot handle the same load as other
servers. The main difference is load distribution is based on a
percentage rather than a weight value. To select distributed load
balancing, set the [LBSERVER] scheme to LB_DISTRIB. The [LBNODE]
sections require a node name, port number, the node&#39;s IP address, and
a percentage value. The nodes with the highest percent values will get
the most connections. The nodes with the lowest percent values will
get the lease number of connections. 
<br /><br />
In the example below, lbnode4 will carry 40% of total
connections. Lbnode3 will carry 30% of the total connections. Lbnode1
and lbnode2 will carry 15% of the total connections. For example: 
<pre>
[LBSERVER]
scheme = LB_DISTRIB

[LBNODE]
node_name = lbnode1
port_number = 80
hostname = 192.168.122.111
weight = 15%

[LBNODE]
node_name = lbnode2
port_number = 80
hostname = 192.168.122.112
weight = 15%

[LBNODE]
node_name = lbnode3
port_number = 80
hostname = 192.168.122.113
weight = %30

[LBNODE]
node_name = lbnode4
port_number = 80
hostname = 192.168.122.114
weight = 40%
</pre>
NOTE: The port numbers in the above example must be substituted
with the port number you are actually using. The use of 4 LBNODE
sections is just an example. Your setup may contain any number of
LBNODE sections depending on how many back end server nodes you have
available.  
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="Assignedconfiguration">Assigned configuration</a></b></font></td>
    </tr>
  </tbody>
</table>
<br />
<p>
The assigned load balancing scheme allows you to assign TCP connections to
specific back end nodes based on the IP address of the incoming
connection. Incoming connections that do not have assignment rules can
be configured to use round robin, weighted, or distributed load
balancing schemes. The same load balancing scheme used for unassigned
connections will be applied to down server nodes handling connection
assignment rules. To select assigned load balancing, set the
[LBSERVER] scheme to LB_ASSIGNED. The [LBNODE] sections require a
node name, port number, and the node&#39;s IP address. In the [LBSERVER]
section, the assigned_default can be set to: 
<br /><br />
LB_RR<br />
LB_DISTRIB<br />
LB_WEIGHTED<br />
LB_NONE
<br /><br />
If you select LB_DISTRIB, each [LBNODE] section will require a
percentage value set for the weight value. If you select LB_WEIGHTED,
each [LBNODE] section will require a weight value.  
<br /><br />
The LB_NONE setting will not connection assigned connections to
another node if the node handling the assignment rules is down.
LB_NONE will use round robin for all incoming connections with no
assignment rules.  
<br /><br />
The assigned load balancing scheme requires a rules configuration
file, set in the [LBSERVER] section&#39;s rules_config_file setting, for
example:
<br /><br />
rules_config_file = /etc/drlb/http_lb_rules.cfg
<br /><br />
If the rules file does not exist, a default file will be created for
you when you test your server configuration or start the DRLB server.
<br /><br />
Below is an assigned load balance configuration using round robin as
the default for 4 back end server nodes:
<pre>
[LBSERVER]
scheme = LB_ASSIGNED
rules_config_file = /etc/drlb/http_lb_rules.cfg
assigned_default = LB_RR

[LBNODE]
node_name = lbnode1
port_number = 80
hostname = 192.168.122.111

[LBNODE]
node_name = lbnode2
port_number = 80
hostname = 192.168.122.112

[LBNODE]
node_name = lbnode3
port_number = 80
hostname = 192.168.122.113

[LBNODE]
node_name = lbnode4
port_number = 80
hostname = 192.168.122.114
</pre>
NOTE: The port numbers in the above example must be substituted
with the port number you are actually using. The use of 4 LBNODE
sections is just an example. Your setup may contain any number of
LBNODE sections depending on how many back end server nodes you have
available.  
<br /><br />
After modifing the DRLB configuration, add your assignment rules to
the rules configuration file. Each assignment rule is designated be
the route key word followed by the IP address of the incoming
connection and the name of the back end server node handling the
assignment. The IP address for the incoming connections can be an IP
address or hostname as a single value or an extended regular
expression. To setup rules, edit the rules file:
<pre>
# vi /etc/drlb/http_lb_rules.cfg

route 192.168.122.1 lbnode1
route ^10.* lbnode2
route ^172\.31\.1.* lbnode3
</pre>
In the examples above, the first route rule directs all traffic from
the 192.168.122.1 IP address to lbnode1. The second example directs
all traffic from the 10.0.0.0/8 network to lbnode2. The third example
directs all traffic from the 172.31.1.0/24 network to lbnode3. All
other incoming traffic will use round robin connections to node 1
through 4. 
<br /><br />
NOTE: Name lookups for hostnames can cause performance issues. If you
need to disable name lookups, edit your DRLB configuration file and
change the following:

<pre>
[LBSERVER]
...
resolve_assigned_hostnames = 0
</pre>

Once disabled, the route rules will only use the IP address of the
incoming connection.
<br /><br />
The assignment rules file is read when the DRLB server starts or is
restarted. Changes to the rules file requires a service restart to take
affect.
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="Throttlingconfiguration">Throttling configuration</a></b></font></td>
    </tr>
  </tbody>
</table>
<br />
<p>
Connection throttling can be used to prevent server saturation by
placing incoming connections into a wait queue. Throttling can be based
on a preset connection count or based on the number of incoming
connections per second. 
<br /><br />
To setup a preset connection throttle, edit your DRLB configuration
file and add the following to the [LBSERVER] global configuration
section: 
<pre>
[LBSERVER]
...
enable_throttling = 1
throttle_every_connections = 10
throttle_wait_secs = 1
throttle_wait_usecs = 0
</pre>
In the example above every 10 connections will be throttled with a
wait queue time of 1 second. If throttle_every_connections is set to
1, every incoming connection will be throttled. 
<br /><br />
To setup connections per second throttling, edit your DRLB configuration
file an add the following to the [LBSERVER] global configuration
section:
<pre>
[LBSERVER]
...
enable_throttling = 1
throttle_apply_by_load = 1
throttle_connections_per_sec = 10
throttle_every_connections = 10
throttle_wait_secs = 1
throttle_wait_usecs = 0
</pre>
In the example above every 10 connections will be throttled when the
incoming server load reaches 10 connections per second. When the load
drops below 10 connections per second, throttling will be disabled
until the load spikes again to 10 per connections second. By default, statistics
collection is every 5 minutes. You can increase or decrease stat
collection time by setting the following global configuration values:
<pre>
stats_min = 5
stats_secs = 0
</pre>
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="Logconfiguration">Log configuration</a></b></font></td>
    </tr>
  </tbody>
</table>
<br />
<p>
DRLB server logging is disabled by default. To get maximum server
performance under extreme load conditions you may want to leave
logging disabled or set the log level to zero. To enable logging, edit
your DRLB configuration file an add the following to the 
[LBSERVER] global configuration section:
<pre>
[LBSERVER]
...
enable_logging = 1
logfile_name = /var/log/drlb/http_lb.log
num_logs_to_keep = 3
max_log_size = 5000000
clear_log = 0
log_level = 0
service_name = http_lb
</pre>
In the above example the DRLB server will log to http_lb.log file. The
maximum log file size will be 5MB and we will keep the current log file and
3 previous copies. The required disk space for log files is equal to:
<br /><br />
max_log_size * (num_logs_to_keep +1)
<br /><br />
The log_level can be set to 0 (lowest) level or 5 (highest) level. The
higher the log level, the more messages will be logged. The
service_name is an optional setting you can use to customize log file
entries.
<br /><br />
To increase server performance you have the option to adjust the
advanced DRLB log settings: 
<pre>
log_queue_size = 2048
log_queue_debug_size = 4096
log_queue_proc_size = 255
</pre>
The log queue size equals the number of log messages the server will
spool. Memory usage is equal to:
<br /><br />
log_queue_size * 255
<br /><br />
Spooling more messages to memory will decrease the consecutive number
of log file writes. The debug queue size only applies if debugging is
enabled. The proc queue size is used for process messages and does not
need to be very large as process messages are written during server
stops, starts, restarts, or process error conditions.  
<br /><br />
To watch the log in real time:
<pre>
# tail -f /var/log/drlb/http_lb.log
</pre>
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="Statisticscollection">Statistics collection</a></b></font></td>
    </tr>
  </tbody>
</table>
<br />
<p>
DRLB server statistics collection is disabled by default. To enable
stat collection, edit your DRLB configuration file an add the
following to the [LBSERVER] global configuration section:
<pre>
[LBSERVER]
...
enable_stats = 1
stats_file_name = /var/log/drlb/http_lb_stats.log
max_stats_size = 5000000
num_stats_to_keep = 3
stats_min = 5
stats_secs = 0
</pre>
In the above example the DRLB server will collect server stats every 5
minutes and write the stat messages to log to http_lb_stats.log file. The
maximum stat file size will be 5MB and we will keep the current stats file
and 3 previous copies. The required disk space for stat files is equal
to:
<br /><br />
max_stats_size * (num_stats_to_keep +1)
<br /><br />
You can increase or decrease stat collection times by adjusting the
stats_min and stats_secs values.
<br /><br />
To watch the stats in real time:
<pre>
# tail -f /var/log/drlb/http_lb_stats.log
</pre>
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="Settingconnectionandthreadlimits">Setting connection and thread limits</a></b></font></td>
    </tr>
  </tbody>
</table>
<br />
<p>
To protect low resource servers from saturation you set connection
limits. Connection limits will stop serving connections when the
maximum number connections is reached. Connection limits can be set
for all back end server nodes or for individual back end server
nodes. To set connection limits for all back end nodes edit your DRLB
server configuration and add the following to the [LBSERVER] section:
<pre>
[LBSERVER]
...
max_connections = 1000
</pre>
This will limit the total number of concurrent connections to
1000. When the 1000 connection limit is reached the DRLB server will
not allow any more connections until the total number of connection
drops below 1000.
<br /><br />
To set the number of connections for individual back end nodes:
<pre>
[LBNODE]
node_name = lbnode1
max_connections = 1000

[LBNODE]
node_name = lbnode2
max_connections = 200

[LBNODE]
node_name = lbnode3
max_connections = 200

[LBNODE]
node_name = lbnode4
max_connections = 200
</pre>
The will limit lbnode1 to 1000 concurrent connections and lbnode2 through lbnode4
to 200 concurrent connections each.
<br /><br />
To limit the number of threads the DRLB server process can generate
you can set the max_threads limit in the [LBSERVER] section:
<pre>
[LBSERVER]
...
max_threads = 1000
</pre>
Limiting the number of threads the DRLB process can generate will limit all
server connection depending on how many client threads are
active. Thread limiting protects server resources when there is a large
number of persistent client connections. 
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="Settingbufferandcachingoptions">Setting buffer and caching options</a></b></font></td>
    </tr>
  </tbody>
</table>
<br />
<p>
Caching is used by default to buffer incoming connections as data is
read from TCP socket connections. In certain network environments it
may be necessary to disable cache buffering or change the default
buffer size. Lowing the buffer size will result in more reads per
connection. Increasing the buffer size will decrease the number of
reads per connection. To set the cache or buffer size settings for all
nodes, edit your configuration file and modify the following
parameters in the [LBSERVER] section:
<pre>
[LBSERVER]
...
use_buffer_cache = 1
buffer_size = 1500
</pre>
To set the buffer size for individual nodes:
<pre>
[LBNODE]
node_name = lbnode1
buffer_size = 1500
...

[LBNODE]
node_name = lbnode2
buffer_size = 1500
...

[LBNODE]
node_name = lbnode3
buffer_size = 1500
...

[LBNODE]
node_name = lbnode4
buffer_size = 1500
...
</pre>
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="Deadnoderetrysettings">Dead node retry settings</a></b></font></td>
    </tr>
  </tbody>
</table>
<br />
<p>
When a back end server node is down for maintenance or hardware
failures you can change the number of retires and the wait time for
retries. To change the retry values, edit your configuration file and
modify the following parameters in the [LBSERVER] section:
<pre>
[LBSERVER]
...
retries = 3
retry_wait = 1
</pre>
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="Bufferoverflowsettings">Buffer overflow settings</a></b></font></td>
    </tr>
  </tbody>
</table>
<br />
<p>
When cache buffer is enabled you can enable buffer overflow protection,
provided you know the packet sizes your application uses. With buffer
overflow protection enabled, the DRLB server will deny a connection if
the number of bytes read on a front end socket connection exceeds the
buffer overflow size. To enable buffer overflow protection edit your
configuration file and modify the following parameters in the
[LBSERVER] section: 
<pre>
[LBSERVER]
...
enable_buffer_overflow_detection = 1
buffer_overflow_size = 5000
</pre>
This will limit incoming socket reads to 5000 bytes per socket read.
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="Advancedsocketsettings">Advanced socket settings</a></b></font></td>
    </tr>
  </tbody>
</table>
<br />
<p>
Each of the setting below are set in the [LBSERVER] global section in
your DRLB server configuration file.
<br /><br />
To listen on a single Ethernet interface:

<pre>
[LBSERVER]
...
listen_ip_addr = 192.168.122.1
</pre>

The default is to listen on all interfaces. 
<br /><br />

To change the maximum number of back logged connections, set the
somaxconn parameter based on the kernel setting:
<pre>
# cat  /proc/sys/net/core/somaxconn 
</pre>
Typically the default value 128 and the maximum value is 1024. If this
value is higher than 128 on your server you can adjust your DRLB configuration:
<pre>
[LBSERVER]
...
somaxconn = 1024
</pre>
Depending on your application you may need to adjust the DRLB socket
options to prevent CPU usage spikes. To adjust the socket options edit
the following options in your configuration file:
<pre>
[LBSERVER]
...
# Idle time for blocking sockets
max_idle_count = 60000
idle_wait_secs = 0
idle_wait_usecs = 500

# Use non-blocking sockets
use_nonblock_sockets = 0
</pre>
The idle time setting adjustments are most effective for a large number
of persistent connections. For connections that stay open for long
periods without transferring data, increasing the values will reduce
CPU usage. Decreasing the idle times or using non-blocking sockets is
most affective for connections that rapidly open and close.
<br /><br />
For applications that rely on timing for socket reads you can set your
DRLB configuration to use blocking reads with timeout values:
<pre>
[LBSERVER]
...
use_buffer_cache = 0
use_timeout = 1
timeout_secs = 300
timeout_usecs = 0
</pre>
This will disable the buffer cache and set the read timeout value to
300 seconds. If the socket connection does not receive data within 300
seconds the connection will close. 
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="DRLBprocessmonitoring">DRLB process monitoring</a></b></font></td>
    </tr>
  </tbody>
</table>
<br />
<p>
Use the shell commands below to watch DRLB CPU, memory, file, and
thread resources.
<br /><br />
Watch percentage of memory:
<pre>
$ watch -n 1 &#39;ps -eo %mem,pid,user,args | grep drlb | grep -v grep&#39;
</pre>
Watch percentage of CPU:
<pre>
$ watch -n 1 &#39;ps -eo %cpu,pid,user,args | grep drlb | grep -v grep&#39;
</pre>
Watch percentage of CPU and memory:
<pre>
$ watch -n 1 &#39;ps -eo %cpu,%mem,pid,etime,args | grep drlb | grep -v grep&#39;
</pre>
Watch memory usage:
<pre>
$ pids=$(ps -ef | grep drlb_server | grep -v grep | awk &#39;{ print $2 }&#39;)
$ for p in $pids; do cat /proc/$p/status | grep -i vmsize; done
</pre>
Watch number of threads:
<pre>
$ pids=$(ps -ef | grep drlb_server | grep -v grep | awk &#39;{ print $2 }&#39;)
$ for p in $pids; do cat /proc/$p/status | grep -i threads; done
</pre>
Watch number of open files:
<pre>
$ pids=$(ps -ef | grep drlb_server | grep -v grep | awk &#39;{ print $2 }&#39;)
$ for p in $pids; do ls -l --color=none /proc/$p/fd; done
</pre>
BASH script to log key process parms in real time:
<pre>
#!/bin/bash

numsecs=9999
pids=$(ps -ef | grep drlb_server | grep -v grep | awk &#39;{ print $2 }&#39;)

echo &quot;Watching:&quot; | tee -a /tmp/watch_drlb_proc.log
ps -ef | grep drlb_server | grep -v grep | tee -a /tmp/watch_drlb_proc.log
echo &quot;&quot; | tee -a /tmp/watch_drlb_proc.log

i=0
while [ $i -le $numsecs ]; do
    let i=i+1
    echo &quot;Num open files:&quot; | tee -a /tmp/watch_drlb_proc.log
    for p in $pids; do ls -l --color=none /proc/$p/fd 2&gt;/dev/null | wc -l; done | tee -a /tmp/watch_drlb_proc.log
    echo &quot;&quot; | tee -a /tmp/watch_drlb_proc.log
    echo &quot;Memory usage:&quot; | tee -a /tmp/watch_drlb_proc.log
    for p in $pids; do cat /proc/$p/status | grep -i vmsize; done | tee -a /tmp/watch_drlb_proc.log
    echo &quot;&quot; | tee -a /tmp/watch_drlb_proc.log
    echo &quot;Num threads &quot; | tee -a /tmp/watch_drlb_proc.log
    for p in $pids; do cat /proc/$p/status | grep -i threads; done | tee -a /tmp/watch_drlb_proc.log
    echo &quot;&quot; | tee -a /tmp/watch_drlb_proc.log
    sleep 1
done
</pre>
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="SettingOpenFileLimits">Setting Open File Limits</a></b></font></td>
    </tr>
  </tbody>
</table>
<!-- End Title Bar -->
<br />
<p>
NOTICE: Any setting you make to change default kernel limits and/or
user limits must be implemented with caution. All changes should be
thoroughly tested on development servers whenever possible. If you are
not careful when adjusting default limits you can render your server
inoperable.
<br /><br />
In RHEL6/CENTOS6 and RHEL7/CENTOS7 the default number of file,
including sockets, is 1024. For load balancer applications with a high
volume of connections you will need to increase the default value.
<br /><br />
For RHEL7/CENTOS7, the global ulimit for nofiles is ignored for
systemd services. The nofile limit is now set in the service file:
<pre>
# more /etc/systemd/system/drlb_server.service

[Service]
LimitNOFILE=65535
</pre>
For RHEL7/CENTOS7 runtime testing you can change the nofile limit for
a process using the prlimit command:
<pre>
# ps -ef | grep drlb_server | grep -v grep
# prlimit --pid [pid] --nofile=32767:65535
</pre>
For RHEL6/CENTOS6, you can increase the max number of open files by
increasing the ulimit value:
<pre>
# vi /etc/security/limits.d/nofile.conf

*    soft    nofile 32767
*    hard    nofile 65535
</pre>
This change will require a reboot.
<br /><br />
For RHEL6/CENTOS6 runtime testing you can manually set the nofile
limits and start the DRLB server the same shell:
<pre>
# ulimit -n 32767
# ulimit -H -n 65535
</pre>
To check the file limits for the DRLB process(es):
<pre>
# pids=$(ps -ef | grep drlb_server | grep -v grep | awk &#39;{ print $2 }&#39;)
# for p in $pids; do cat /proc/$p/limits | grep -i file; done
</pre>
The Max open files setting should match your ulimit settings for soft
and hard limits. To see how many files the process(es) have open:
<pre>
# for p in $pids; do ls -l --color=none /proc/$p/fd; done
</pre>
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<!-- Begin Title Bar -->
<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="LinuxKernelTuning">Linux Kernel Tuning</a></b></font></td>
    </tr>
  </tbody>
</table>
<!-- End Title Bar -->
<br />
<p>
NOTICE: Any setting you make to change default kernel settings and/or
user limits must be implemented with caution. All changes should be
thoroughly tested on development servers whenever possible. If you are
not careful when adjusting default kernel settings you can render your 
server inoperable.
<br /><br />
Load balancing will require kernel tuning based the volume of traffic
and type of TCP service you are load balancing. NOTE: The values in
listed below are based on extremely high volume. Depending on your
application you may not need to set many of the parameters listed. But
please keep in mind that you will need to tune the kernel for any
server acting as a load balancer. 
<br /><br />
All setting listed below must be application tested and set based on
the number of connections to your frontend LB and backend hosts. For
each of the settings below use the sysctl command to backup the
orginal settings before making any changes, for example:
<br /><br />
# sysctl fs.file-max | tee -a /root/sysctl_org_settings.txt
<br /><br />
To make the changes persistent, add the setting(s) to the sysctl.conf
file: 
<br /><br />
CENTOS 5/6 or RHEL 5/6:<br />
# vi /etc/sysctl.conf
<br /><br />
CENTOS 7 or RHEL 7:<br />
# vi /usr/lib/sysctl.d/00-system.conf
<br /><br />
To load changes CENTOS 5/6 or RHEL 5/6:<br />
# sysctl -p
<br /><br />
To load changes CENTOS 7 or RHEL 7:<br />     
# sysctl -p  /usr/lib/sysctl.d/00-system.conf
<pre>
File Handle Limits:
------------------
Increase the maximum number of open file descriptors:

fs.file-max = 25000000

IPv4 Socket Tuning:
------------------
For a large numbers of concurent sessions:

net.ipv4.ip_local_port_range = 1024 65535
net.ipv4.tcp_tw_recycle = 1
net.ipv4.tcp_tw_reuse = 1
net.ipv4.tcp_fin_timeout = 60
net.core.rmem_max = 16777216
net.core.wmem_max = 16777216
net.ipv4.tcp_max_syn_backlog = 4096
net.ipv4.tcp_syncookies = 1
net.core.somaxconn = 1024

IPv4 Settings:

net.ipv4.ip_forward = 1
net.ipv4.ipfrag_max_dist = 4096
net.ipv4.ip_nonlocal_bind=1

Process Scheduler:
-----------------
Increase time for process run time before the kernel will consider
migrating it again to another core: 

CENTOS 5/6 or RHEL 5/6:

kernel.sched_migration_cost = 5000000

CENTOS 7 or RHEL 7:

kernel.sched_migration_cost_ns = 5000000

kernel.sched_autogroup_enabled = 0

Threads:
-------
Increase maximum number of threads that can be created by a process:

kernel.threads-max = 5000000
vm.max_map_count = 128000
kernel.pid_max = 65536
</pre>
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<!-- Begin Title Bar -->
<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="TestingwithApache">Testing with Apache</a></b></font></td>
    </tr>
  </tbody>
</table>
<!-- End Title Bar -->
<br />
<p>
A simple way to test your DRLB server is to use Apache on KVM virtual
machines. Once you have Apache running on a one or more virtual
machines copy the following PHP scripts to the Web root on each VM,
for example 
<pre>
$ cd $HOME/git/datareel/load_balancer/apache_test
$ chmod 644 *.php

$ for s in 192.168.122.111 192.168.122.112 192.168.122.113 192.168.122.114 
&gt; do
&gt; scp -p *.php username@${s}:/var/www/html/.
&gt; done

$ cd $HOME/git/datareel/load_balancer/drlb_server
$ ./drlb_server --config-file=../etc/http_rr_test.cfg --log-file=/tmp/http_rr.log &gt; /tmp/drlb_start.log &amp;
</pre>
To connect using wget, assuming the DRLB server is listening on port
8080 on the bare metal host:
<pre>
$ cd /tmp
$ wget -O index.html http://192.168.122.1:8080
</pre>
Persistent TCP connection:
<pre>
$ wget -O loop1.txt http://192.168.122.1:8080
</pre>
NOTE: If you test using Firefox, you will be limited to 6
persistent session. By default Firefox only allow 6 simultaneous
downloads. To increase this limit for testing, enter the following URL: 
<br /><br />
about:config
<br /><br />
Search for:
<br /><br />
network.http.max-persistent-connections-per-server
<br /><br />
Change the default from 6 to a higher number.
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="HTTPIPaddressforwarding">HTTP IP address forwarding</a></b></font></td>
    </tr>
  </tbody>
</table>
<!-- End Title Bar -->
<br />
<p>
Each of the setting below are set in the [LBSERVER] global section in
your DRLB server configuration file. To enable HTTP IP address
forwarding edit your configuration file and add the following:
<pre>
[LBSERVER]
...
enable_http_forwarding = 1
http_request_strings = GET,HEAD,POST
http_hdr_str = HTTP/
http_forward_for_str = X-Forwarded-For
</pre>
NOTE: To see forwarded IP addresses in your Apache log entries you
must add the following to your httpd conf:
<pre>
LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %>s %b %{X-Forwarded-For}i \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot;&quot; combined
LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %>s %b&quot; %{X-Forwarded-For}i common
</pre>
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<!-- Begin Title Bar -->
<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="Remainingworkonthisproject">Remaining work on this project</a></b></font></td>
    </tr>
  </tbody>
</table>
<!-- End Title Bar -->
<br />
<p>
&nbsp;<br />
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<!-- Begin Title Bar -->
<table border="0" cellpadding="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="A0CCFF"><font face="Arial,Helvetica,Sans-serif"><b>&nbsp;<a name="SupportandBugTracking">Support and Bug Tracking</a></b></font></td>
    </tr>
  </tbody>
</table>
<!-- End Title Bar -->
<br />
<p>
<a href="https://github.com/datareel/datareel/issues">https://github.com/datareel/datareel/issues</a>
</p>
<p class="pull-left"><a href="#">Back to top</a></p>

<br />
<hr color="#000000" noshade="noshade" size="1" /><!-- Start Copyright Information -->
<p><font color="000000">Copyright &copy; 2001-2016&nbsp;DataReel OpenSource</font></p>

	
<!-- My Content Ends Above -->
      </div>
    </div><!-- /.container -->

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster
    -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script>window.jQuery ||
    document.write('<script src="../js/vendor/jquery.min.js"><\/script>')</script>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new
      Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-83583599-1', 'auto');
      ga('send', 'pageview');
    </script>

  </body>
</html>
